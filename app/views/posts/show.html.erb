<p id="notice"><%= notice %></p>

<p>
  <strong>Title:</strong>
  <%= @post.title %>
</p>

<p>
  <strong>Content:</strong>
  <%= @post.content %>
</p>

<%= form_tag create_comment_to_post_path, id: "comment" do %>
  <%= text_field_tag :body%>
  <%= submit_tag "댓글달기"%>
<%end%>

<%= link_to 'Edit', edit_post_path(@post), class: "btn btn-warning" %> |
<%= link_to 'Back', posts_path, class: "btn btn-success" %>

<% if @like %>
  <%= link_to "Like".html_safe, like_to_post_path, class: "btn btn-info", id: "like_button" %>
<%else%>
  <%= link_to "DisLike".html_safe, like_to_post_path, class: "btn btn-danger", id: "like_button" %>
<%end%>
(<span id='like_count'><%=@post.likes.count%></span>)

<table class="table" id="comment_table">
  <thead>
    <tr>
      <th>댓글</th>  
    <tr>
  </thead>
  <tbody>
    <% @post.comments.each do |p|%>
      <tr>
        <!--<--%= form_tag destroy_comment_to_posts_path, id:"comments" do%>-->
        <td id="comment_content"><%= p.body%><td>
        <!--<td>-->
        <!--  <--%= submit_tag "댓글 삭제"%>-->
        <!--<td>-->
        <!--<--%end%>-->
      </tr>
    <%end%>
  </tbody>
</table>

<script>
  $(function(){
    $('#like_button').on('click', function(e){
      e.preventDefault();
      //console.log("Like button Clicked");
      $.ajax({
        method: "POST",
        url: "<%= like_to_post_path%>"
      })
    })
    
    var form = $('#comment');
    form.on('click', function() {
      /*alert("댓글 등록해");*/
    })
    
    form.on('submit', function(e){
      e.preventDefault();
      var contents = $('#body').val();
      alert(contents+" 라고 등록할꺼?");
      $.ajax({
        url: "<%= create_comment_to_post_path%>",
        method: "POST",
        data: {body: contents}
      })
    })
    
    // var delete_form = $('#comments');
    // var id = $(this).attr('id');
    // delete_form.on('submit',function(e){
    //   e.preventDefault();
    //   $.ajax({
    //     url: "<--%= destroy_comment_to_posts_path%>",
    //     method: "DELETE",
    //     data: {body: $('#comment_content')},
    //     success:function(result){
    //       if(result=="OK"){
    //         $('#comment_content').remove();
    //         alert("삭제되었습니다.");
    //       }else{
    //         alert("삭제 ㄴㄴ");
    //       }
    //     }
    //   })
    // })
  })
</script>